<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë‹¤ë‚­ ì—¬í–‰ íŠ¸ë˜ì»¤ - ë°ì´í„° ë°±ì—…/ë³µêµ¬</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            padding: 40px;
        }

        h1 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 28px;
        }

        .subtitle {
            color: #6b7280;
            margin-bottom: 30px;
            font-size: 14px;
        }

        .section {
            margin-bottom: 40px;
            padding: 30px;
            background: #f9fafb;
            border-radius: 12px;
            border: 2px solid #e5e7eb;
        }

        .section h2 {
            color: #1f2937;
            margin-bottom: 15px;
            font-size: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section p {
            color: #6b7280;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(102, 126, 234, 0.6);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .output {
            margin-top: 20px;
            padding: 20px;
            background: white;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #d1d5db;
            display: none;
        }

        .output.show {
            display: block;
        }

        .output pre {
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .status {
            padding: 12px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-weight: 500;
            display: none;
        }

        .status.show {
            display: block;
        }

        .status.success {
            background: #d1fae5;
            color: #065f46;
            border: 1px solid #6ee7b7;
        }

        .status.error {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #fca5a5;
        }

        .status.info {
            background: #dbeafe;
            color: #1e40af;
            border: 1px solid #93c5fd;
        }

        .file-input-wrapper {
            margin-top: 15px;
        }

        input[type="file"] {
            display: none;
        }

        .file-label {
            display: inline-block;
            background: #f3f4f6;
            color: #374151;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            border: 2px dashed #d1d5db;
            transition: all 0.3s;
        }

        .file-label:hover {
            border-color: #667eea;
            background: #eef2ff;
        }

        .icon {
            font-size: 24px;
        }

        .info-box {
            background: #fef3c7;
            border: 1px solid #fbbf24;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .info-box strong {
            color: #92400e;
        }

        .info-box p {
            color: #78350f;
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸŒ´ ë‹¤ë‚­ ì—¬í–‰ íŠ¸ë˜ì»¤</h1>
        <p class="subtitle">ë°ì´í„° ë°±ì—… ë° ë³µêµ¬ ë„êµ¬</p>

        <div class="info-box">
            <strong>âš ï¸ ì¤‘ìš” ì•ˆë‚´</strong>
            <p>â€¢ ì—¬í–‰ ì „ ë°˜ë“œì‹œ ë°±ì—…ì„ ë°›ì•„ë‘ì„¸ìš”</p>
            <p>â€¢ ë°±ì—… íŒŒì¼ì€ ì•ˆì „í•œ ê³³ì— ë³´ê´€í•˜ì„¸ìš” (ì´ë©”ì¼, í´ë¼ìš°ë“œ ë“±)</p>
            <p>â€¢ ë³µêµ¬ ì‹œ ê¸°ì¡´ ë°ì´í„°ê°€ ë®ì–´ì”Œì›Œì§‘ë‹ˆë‹¤</p>
        </div>

        <!-- ë°±ì—… ì„¹ì…˜ -->
        <div class="section">
            <h2>
                <span class="icon">ğŸ’¾</span>
                ë°ì´í„° ë°±ì—…
            </h2>
            <p>
                í˜„ì¬ localStorageì— ì €ì¥ëœ ëª¨ë“  ì—¬í–‰ ë°ì´í„°ë¥¼ JSON íŒŒì¼ë¡œ ë‚´ë³´ëƒ…ë‹ˆë‹¤.
                ë‚ ì”¨ ìºì‹œ, ì²´í¬ì¸ ê¸°ë¡, ì„¤ì • ë“±ì´ í¬í•¨ë©ë‹ˆë‹¤.
            </p>
            <button id="backupBtn" onclick="backupData()">ë°±ì—… íŒŒì¼ ìƒì„± ë° ë‹¤ìš´ë¡œë“œ</button>

            <div id="backupStatus" class="status"></div>
            <div id="backupOutput" class="output"></div>
        </div>

        <!-- ë³µêµ¬ ì„¹ì…˜ -->
        <div class="section">
            <h2>
                <span class="icon">ğŸ”„</span>
                ë°ì´í„° ë³µêµ¬
            </h2>
            <p>
                ì´ì „ì— ë°±ì—…í•œ JSON íŒŒì¼ì„ ì„ íƒí•˜ì—¬ ë°ì´í„°ë¥¼ ë³µêµ¬í•©ë‹ˆë‹¤.
                ë³µêµ¬ í›„ í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ë©´ ë³€ê²½ì‚¬í•­ì´ ì ìš©ë©ë‹ˆë‹¤.
            </p>

            <div class="file-input-wrapper">
                <input type="file" id="restoreFile" accept=".json" onchange="restoreData(event)">
                <label for="restoreFile" class="file-label">
                    ğŸ“‚ ë°±ì—… íŒŒì¼ ì„ íƒ
                </label>
            </div>

            <div id="restoreStatus" class="status"></div>
            <div id="restoreOutput" class="output"></div>
        </div>

        <!-- ë°ì´í„° í™•ì¸ ì„¹ì…˜ -->
        <div class="section">
            <h2>
                <span class="icon">ğŸ“Š</span>
                í˜„ì¬ ë°ì´í„° í™•ì¸
            </h2>
            <p>
                í˜„ì¬ localStorageì— ì €ì¥ëœ ë°ì´í„°ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.
            </p>
            <button onclick="viewCurrentData()">í˜„ì¬ ë°ì´í„° ë³´ê¸°</button>

            <div id="viewStatus" class="status"></div>
            <div id="viewOutput" class="output"></div>
        </div>

        <!-- ë°ì´í„° ì‚­ì œ ì„¹ì…˜ -->
        <div class="section" style="border-color: #fca5a5;">
            <h2 style="color: #dc2626;">
                <span class="icon">ğŸ—‘ï¸</span>
                ë°ì´í„° ì‚­ì œ
            </h2>
            <p style="color: #dc2626;">
                âš ï¸ ìœ„í—˜: ëª¨ë“  localStorage ë°ì´í„°ê°€ ì˜êµ¬ ì‚­ì œë©ë‹ˆë‹¤. ë³µêµ¬ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤!
            </p>
            <button onclick="clearData()" style="background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);">
                ëª¨ë“  ë°ì´í„° ì‚­ì œ
            </button>

            <div id="clearStatus" class="status"></div>
        </div>
    </div>

    <script>
        // ë°±ì—… ë°ì´í„° ìƒì„± ë° ë‹¤ìš´ë¡œë“œ
        function backupData() {
            try {
                const backupBtn = document.getElementById('backupBtn');
                backupBtn.disabled = true;
                backupBtn.textContent = 'ë°±ì—… ì¤‘...';

                // localStorage ì „ì²´ ë°ì´í„° ìˆ˜ì§‘
                const backup = {
                    version: '1.0',
                    timestamp: new Date().toISOString(),
                    device: navigator.userAgent,
                    data: {}
                };

                // ëª¨ë“  localStorage í•­ëª© ë°±ì—…
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    backup.data[key] = localStorage.getItem(key);
                }

                // JSON ë¬¸ìì—´ë¡œ ë³€í™˜
                const jsonString = JSON.stringify(backup, null, 2);
                const blob = new Blob([jsonString], { type: 'application/json' });

                // íŒŒì¼ ë‹¤ìš´ë¡œë“œ
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `danang-travel-backup-${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);

                // ì„±ê³µ ë©”ì‹œì§€
                showStatus('backupStatus', 'success', 'âœ… ë°±ì—… íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!');
                showOutput('backupOutput', jsonString);

                backupBtn.disabled = false;
                backupBtn.textContent = 'ë°±ì—… íŒŒì¼ ìƒì„± ë° ë‹¤ìš´ë¡œë“œ';

            } catch (error) {
                console.error('Backup error:', error);
                showStatus('backupStatus', 'error', 'âŒ ë°±ì—… ì‹¤íŒ¨: ' + error.message);

                backupBtn.disabled = false;
                backupBtn.textContent = 'ë°±ì—… íŒŒì¼ ìƒì„± ë° ë‹¤ìš´ë¡œë“œ';
            }
        }

        // ë°±ì—… ë°ì´í„° ë³µêµ¬
        function restoreData(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const backup = JSON.parse(e.target.result);

                    // ë°±ì—… íŒŒì¼ ìœ íš¨ì„± ê²€ì¦
                    if (!backup.version || !backup.data) {
                        throw new Error('ìœ íš¨í•˜ì§€ ì•Šì€ ë°±ì—… íŒŒì¼ì…ë‹ˆë‹¤');
                    }

                    // í™•ì¸ ëŒ€í™”ìƒì
                    if (!confirm('í˜„ì¬ ë°ì´í„°ê°€ ëª¨ë‘ ì‚­ì œë˜ê³  ë°±ì—… ë°ì´í„°ë¡œ ë³µì›ë©ë‹ˆë‹¤. ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                        showStatus('restoreStatus', 'info', 'â„¹ï¸ ë³µêµ¬ê°€ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤');
                        return;
                    }

                    // localStorage ì´ˆê¸°í™”
                    localStorage.clear();

                    // ë°±ì—… ë°ì´í„° ë³µì›
                    let restoredCount = 0;
                    for (const [key, value] of Object.entries(backup.data)) {
                        localStorage.setItem(key, value);
                        restoredCount++;
                    }

                    // ì„±ê³µ ë©”ì‹œì§€
                    const message = `âœ… ${restoredCount}ê°œ í•­ëª©ì´ ë³µêµ¬ë˜ì—ˆìŠµë‹ˆë‹¤!\në°±ì—… ì‹œê°„: ${new Date(backup.timestamp).toLocaleString('ko-KR')}\n\ní˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ì„¸ìš”.`;
                    showStatus('restoreStatus', 'success', message);
                    showOutput('restoreOutput', JSON.stringify(backup, null, 2));

                    // 3ì´ˆ í›„ ìë™ ìƒˆë¡œê³ ì¹¨
                    setTimeout(() => {
                        if (confirm('í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                            window.location.reload();
                        }
                    }, 3000);

                } catch (error) {
                    console.error('Restore error:', error);
                    showStatus('restoreStatus', 'error', 'âŒ ë³µêµ¬ ì‹¤íŒ¨: ' + error.message);
                }
            };

            reader.readAsText(file);
        }

        // í˜„ì¬ ë°ì´í„° í™•ì¸
        function viewCurrentData() {
            try {
                const data = {};
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    data[key] = localStorage.getItem(key);
                }

                const jsonString = JSON.stringify(data, null, 2);
                const itemCount = Object.keys(data).length;

                showStatus('viewStatus', 'info', `â„¹ï¸ í˜„ì¬ ${itemCount}ê°œ í•­ëª©ì´ ì €ì¥ë˜ì–´ ìˆìŠµë‹ˆë‹¤`);
                showOutput('viewOutput', jsonString);

            } catch (error) {
                console.error('View error:', error);
                showStatus('viewStatus', 'error', 'âŒ ë°ì´í„° í™•ì¸ ì‹¤íŒ¨: ' + error.message);
            }
        }

        // ëª¨ë“  ë°ì´í„° ì‚­ì œ
        function clearData() {
            if (!confirm('âš ï¸ ì •ë§ë¡œ ëª¨ë“  ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!')) {
                return;
            }

            if (!confirm('âš ï¸ ìµœì¢… í™•ì¸: ì •ë§ë¡œ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                return;
            }

            try {
                const itemCount = localStorage.length;
                localStorage.clear();

                showStatus('clearStatus', 'success', `âœ… ${itemCount}ê°œ í•­ëª©ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤`);

                // 2ì´ˆ í›„ ìë™ ìƒˆë¡œê³ ì¹¨
                setTimeout(() => {
                    window.location.reload();
                }, 2000);

            } catch (error) {
                console.error('Clear error:', error);
                showStatus('clearStatus', 'error', 'âŒ ì‚­ì œ ì‹¤íŒ¨: ' + error.message);
            }
        }

        // ìƒíƒœ ë©”ì‹œì§€ í‘œì‹œ
        function showStatus(elementId, type, message) {
            const statusEl = document.getElementById(elementId);
            statusEl.className = `status show ${type}`;
            statusEl.textContent = message;
        }

        // ì¶œë ¥ ë°ì´í„° í‘œì‹œ
        function showOutput(elementId, data) {
            const outputEl = document.getElementById(elementId);
            outputEl.className = 'output show';
            outputEl.innerHTML = `<pre>${data}</pre>`;
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ localStorage ê°œìˆ˜ í‘œì‹œ
        window.onload = function() {
            const itemCount = localStorage.length;
            console.log(`Current localStorage items: ${itemCount}`);
        };
    </script>
</body>
</html>
